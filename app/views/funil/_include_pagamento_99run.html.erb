<script src="/funil/pagamento.js?<%= Time.now.to_i %>" ></script>
<script src="https://js.iugu.com/v2"></script>


<% if @boleto %>
    <div class="col-lg-6 offset-lg-2" id="formCartao">
        <div class="card-wrapper mt-4"></div>

        <div class="form-container active mt-4">
             <form class="cartao">
                <div class="form-row form-container mt-4">

                    <div class="col-12">
                        <input class="form-control cpf" value="<%= @usuario.cpf %>" placeholder="CPF" type="text" name="cpf" id="cpf">
                    </div>

                    <div class="col-12">
                        <input class="form-control" value="<%= @usuario.nome %>" placeholder="Nome" type="text" name="nome" id="nome">
                    </div>

                    <div class="col-12">
                        <input class="form-control telefone" value="<%= @usuario.telefone %>" placeholder="Telefone" type="text" name="telefone" id="telefone">
                    </div>

                    <div class="col-12">
                        <input class="form-control" value="<%= @usuario.email %>" placeholder="E-mail" type="text" name="email" id="email">
                    </div>

                    <div class="col-12">
                        <input class="form-control cep" value="<%= @usuario.cep %>" placeholder="CEP" onblur="promocao.carregarEndereco(this.value)" type="text" name="cep" id="cep">
                    </div>

                    <div class="col-12">
                        <input class="form-control" value="<%= @usuario.endereco %>" placeholder="Endereço" type="text" name="endereco" id="endereco">
                    </div>

                    <div class="col-12">
                        <input class="form-control" value="<%= @usuario.numero %>" placeholder="Número" type="number" name="numero" id="numero">
                    </div>

                    <div class="col-12">
                        <input class="form-control" value="<%= @usuario.complemento %>" placeholder="Complemento" type="text" name="complemento" id="complemento">
                    </div>

                    <div class="col-12">
                        <input class="form-control" value="<%= @usuario.cidade %>" placeholder="Cidade" type="text" name="cidade" id="cidade">
                    </div>

                    <div class="col-12">
                        <input class="form-control" value="<%= @usuario.estado %>" placeholder="Estado" type="text" name="estado" id="estado">
                    </div>
                </div>
            </form>
        <% if @produto.present? && @produto.instance_variable_get("@table").keys.present? %>
            <p class="title-box mt-5">Aproveite e adicione</p>
            <div class="text-center box-promotion">
                <div class="row">
                    <div class="col-lg-6 align-self-center">
                        <img src="<%= @produto.foto %>" class="img-fluid"/>
                        <span style="color: #fff;">R$ <%= @produto.preco %></span>
                    </div>

                    <div class="col-lg-6 align-self-center">
                        <div class="video">
                            <iframe width="100%" height="150" src="<%= @produto.video_embed %>" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-12 align-self-center text-center">
                        <div class="custom-control custom-checkbox">
                            <input type="checkbox" value="<%= @produto.id %>" onclick="promocao.addCarrinhoCheckBox(this);" class="custom-control-input" id="maisProdutos">
                            <label class="custom-control-label -label-check" for="maisProdutos">Sim vou aproveitar! </label>
                        </div>
                    </div>
                </div>
            </div>
            <% end %>

            <div class="total d-xs-block d-md-none">
                Total<br><span class="price">R$39,90</span> <span class="frete">frete <span class="gratis">grátis</span></span>
            </div>

            <div class="col-12 mt-5 text-center">
                <button class="button-default-green d-block w-100" onclick="promocao.gerarBoleto(this, <%= @pagina.id %>, <%= @pagina.produto_id %>);" placeholder="CVC" >Gerar boleto</button>
            </div>
        </div>
    </div>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.0/jquery.mask.js"></script>
    <script type="text/javascript">
      $('.cep').mask('99999-999');
      $('.telefone').mask('(99) 99999-9999');
      $('.cpf').mask('999.999.999-99');
    </script>
<% else %>
    <div class="col-lg-6 offset-lg-2" id="formCartao">
        <div class="card-wrapper mt-4"></div>

        <div class="form-container active mt-4">
            <form class="cartao">
                <div class="form-row form-container mt-4">
                    <div class="col-12">
                        <input class="form-control" value="" placeholder="Número do cartão" type="tel" name="number" id="numeroCartao">
                    </div>

                    <div class="col-12">
                        <input class="form-control" value="" placeholder="Nome do titular" type="text" name="name" id="nomeCartao">
                    </div>
                    
                    <div class="col-4">
                        <input class="form-control" value="" placeholder="MM/AA" type="tel" name="expiry" id="mesAnoCartao">
                    </div>
                    
                    <div class="col-4">
                        <input class="form-control" value="" placeholder="CVC" type="number" name="cvc" id="cvvCartao">
                    </div>

                    <div class="col-4">
                        <select class="form-control" name="parcelas" id="parcelas" style="height: 60px;margin-top: 10px;">
                          <option value="1">1x</option>
                          <option value="2">2x</option>
                          <option value="3">3x</option>
                          <option value="4">4x</option>
                          <option value="5">5x</option>
                          <option value="6">6x</option>
                          <option value="7">7x</option>
                          <option value="8">8x</option>
                          <option value="9">9x</option>
                          <option value="10">10x</option>
                          <option value="11">11x</option>
                          <option value="12">12x</option>
                        </select>
                    </div>
                </div>
            </form>

        <% if @produto.present? && @produto.instance_variable_get("@table").keys.present? %>
            <p class="title-box mt-5">Aproveite e adicione</p>
            <div class="text-center box-promotion">
                <div class="row">
                    <div class="col-lg-6 align-self-center">
                        <img src="<%= @produto.foto %>" class="img-fluid"/>
                        <span style="color: #fff;">R$ <%= @produto.preco %></span>
                    </div>

                    <div class="col-lg-6 align-self-center">
                        <div class="video">
                            <iframe width="100%" height="150" src="<%= @produto.video_embed %>" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-12 align-self-center text-center">
                        <div class="custom-control custom-checkbox">
                            <input type="checkbox" value="<%= @produto.id %>" onclick="promocao.addCarrinhoCheckBox(this);" class="custom-control-input" id="maisProdutos">
                            <label class="custom-control-label -label-check" for="maisProdutos">Sim vou aproveitar! </label>
                        </div>
                    </div>
                </div>
            </div>
            <% end %>

            <div class="total d-xs-block d-md-none">
                Total<br><span class="price">R$39,90</span> <span class="frete">frete <span class="gratis">grátis</span></span>
            </div>

            <div class="col-12 mt-5 text-center">
                <button class="button-default-green d-block w-100" onclick="promocao.confirmarCompra(this, <%= @pagina.id %>, <%= @pagina.produto_id %>);" placeholder="CVC" >Efetuar pagamento</button>
            </div>
        </div>
    </div>
    <script type="text/javascript" src="/99run/assets/js/jquery.card.js"></script>
    <script>
        new Card({
            form: document.querySelector('form.cartao'),
            container: '.card-wrapper',
            placeholders: {
                number: '•••• •••• •••• ••••',
                name: 'Nome do titular',
                expiry: '••/••',
                cvc: '•••'
            },
        });
    </script>
<% end %>
<style type="text/css">
  .jsUpsell{
    position: absolute;
    height: 100vh;
    width: 100%;
    background-color: #000;
    z-index: 99999;
    top: 0px;
    left: 0px;
    display: none;
    overflow: scroll;
  }
</style>
<div class="jsUpsell"></div>


